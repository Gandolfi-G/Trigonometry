<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>02. Périmètre — Demi-cercle → π</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <!-- JSXGraph (CDN) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css">
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>

  <style>
    .board-wrap{max-width:720px;margin:1rem 0}
    /* carré pour rester cohérent avec la page 01 */
    #perimetre-box{width:100%;aspect-ratio:1/1;border:1px solid #e5e7eb;border-radius:10px}
    .legend { color: var(--muted, #6b7280); font-size: .95rem; margin-top: .5rem }
    .controls{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center;margin-top:.6rem}
    .btn{background:#1c2233;color:#e5e7eb;border:1px solid #2a344b;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .slider{appearance:none;width:240px;height:6px;border-radius:6px;background:#1f2937;outline:none}
    .slider::-webkit-slider-thumb{appearance:none;width:16px;height:16px;border-radius:50%;background:#f59e0b;cursor:pointer;border:1px solid #2a344b}
    .slider::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:#f59e0b;cursor:pointer;border:1px solid #2a344b}
    .hint{font-size:.85rem;color:var(--muted,#6b7280)}
  </style>
</head>
<body>
<header>
  <div class="nav-container">
    <div class="brand"><a href="trigonometry.html">Trigonométrie</a></div>
    <nav><a href="index.html">Accueil</a></nav>
  </div>
</header>

<main class="container page-with-toc">
  <div>
    <h1 id="top">02. Périmètre du cercle unité</h1>
    <p class="lead">On “déroule” le demi-cercle du cercle unité sur une règle : on lit environ <strong>3,14</strong>. Cette longueur est notée <strong>&pi;</strong> ; donc le périmètre complet vaut <strong>2&pi;</strong>.</p>

    <!-- Animation en tête de page -->
    <div class="board-wrap">
      <div id="perimetre-box" aria-label="Animation du demi-cercle qui se déroule en segment π"></div>

      <div class="controls">
        <button id="btnPlay"  class="btn">▶︎ Play</button>
        <button id="btnPause" class="btn" disabled>⏸ Pause</button>
        <button id="btnReset" class="btn" disabled>↺ Reset</button>
        <input id="slider" class="slider" type="range" min="0" max="1" step="0.005" value="0" />
        <span class="hint">Arc → Segment</span>
      </div>

      <div class="legend" id="legend">Le demi-cercle (longueur π) est déroulé sur la règle…</div>
    </div>

    <section id="pi">
      <h2>&pi; : la longueur du demi-périmètre</h2>
      <p>
        Sur le <strong>cercle unité</strong>, le rayon vaut <strong>1</strong>. Si l’on prend le <strong>demi-cercle supérieur</strong>
        et qu’on le « déroule » sur une règle (comme dans l’animation), on obtient une longueur qui n’est pas un nombre simple.
        Cette longueur est notée <strong>&pi;</strong>.
      </p>
      <p>
        Sur une règle, on peut seulement en donner une <strong>approximation</strong> :
        <strong>&pi; &asymp; 3,14</strong>.
        Autrement dit, <strong>3,14</strong> est une valeur <em>approchée</em>, tandis que <strong>&pi;</strong> désigne la valeur exacte.
      </p>
    </section>

    <section id="formule">
      <h2>Formule du périmètre d’un cercle</h2>
      <p>
        Pour un cercle de rayon <strong>r</strong>, le périmètre (la circonférence) est :
        <strong>P = 2&pi;r</strong>.
        (Équivalent : <strong>P = &pi;d</strong> avec <strong>d</strong> le diamètre.)
      </p>
      <p>
        Dans le cas du <strong>cercle unité</strong> (rayon <strong>r = 1</strong>), on obtient :
        <strong>P = 2&pi;</strong>. Donc le <strong>demi-périmètre</strong> vaut <strong>&pi;</strong>.
      </p>
    </section>

    <section id="points-cles">
      <h2>Points-clés</h2>
      <ul>
        <li>Cercle unité : rayon 1.</li>
        <li>Demi-périmètre = &pi; &asymp; 3,14.</li>
        <li>Formule générale : <strong>P = 2&pi;r</strong>.</li>
        <li>Pour le cercle unité : <strong>P = 2&pi;</strong>.</li>
      </ul>
    </section>

    <section id="exercices">
      <h2>Exercices rapides</h2>
      <ol>
        <li>Donner la longueur d’un arc correspondant à un angle de 120° sur le cercle unité.</li>
        <li>Que vaut la longueur d’arc entre 0 et <span style="white-space:nowrap">3&pi;/2</span> ?</li>
      </ol>
    </section>

    <div class="spacer"></div>
    <a class="button" href="trigonometry.html">Sommaire</a>
    <a class="button" href="trigo-03-radian.html">Suivant →</a>
  </div>

  <aside class="local-toc">
    <h3>Sur cette page</h3>
    <ul>
      <li><a href="#top">Titre</a></li>
      <li><a href="#pi">&pi; (demi-périmètre)</a></li>
      <li><a href="#formule">Formule du périmètre</a></li>
      <li><a href="#points-cles">Points-clés</a></li>
      <li><a href="#exercices">Exercices</a></li>
    </ul>
  </aside>
</main>

<footer><div class="container">© 2025 Enseignant de Mathématiques à Genève</div></footer>

<script src="script.js"></script>
<script>
(() => {
  // --- Board JSXGraph ---
  // Pour que tout rentre DANS UN CARRÉ, on "dézoome" un peu : on laisse plus d'espace à droite.
  // On utilise une bounding box large (plus large que haute) et JSXGraph "letterbox" dans le carré,
  // ce qui évite de couper le cercle.
  const BB = [-2.2, 3, 2.6, -2.2]; // carré centré vers la gauche, on voit le cercle + la règle
  const board = JXG.JSXGraph.initBoard('perimetre-box', {
    boundingbox: BB,
    axis: true,
    grid: true,
    keepaspectratio: true,
    showNavigation: false,
    showCopyright: false,
    // On fige l'interaction : pas de pan / zoom (on évite de "casser" la mise en page règle + cercle)
    pan:  { enabled: false },
    zoom: { enabled: false, wheel: false, pinch: false }
  });

  // --- Mise en page : zone blanche "au-dessus" pour la règle ---
  // La grille et les axes restent actifs sur le board, mais on les masque sur une bande supérieure.
  const ySplit = 1.9; // séparation visuelle (au-dessus = règle, en dessous = cercle + grille)
  const m1 = board.create('point', [BB[0], BB[1]], { visible: false, fixed: true, highlight: false });
  const m2 = board.create('point', [BB[2], BB[1]], { visible: false, fixed: true, highlight: false });
  const m3 = board.create('point', [BB[2], ySplit], { visible: false, fixed: true, highlight: false });
  const m4 = board.create('point', [BB[0], ySplit], { visible: false, fixed: true, highlight: false });
  const topMask = board.create('polygon', [m1, m2, m3, m4], {
    fillColor: '#ffffff',
    fillOpacity: 1,
    borders: { strokeWidth: 0 },
    fixed: true,
    highlight: false,
    layer: 2
  });
  // Ceinture + bretelles : on fige les sommets de la zone masque.
  topMask.vertices.forEach(v => v.setAttribute({ visible: false, fixed: true, highlight: false }));

  // --- Scène : cercle + arc demi-cercle + règle + morphing ---
  const O = board.create('point', [0, 0], { name: '', visible: false, fixed: true, highlight: false });
  const circle = board.create('circle', [O, 1], { strokeColor: '#eab308', strokeWidth: 4, fixed: true, highlight: false });

  // Points de l'arc (0→π) et de la ligne cible (0→π) posée à droite
  const steps = 240;
  const arcPts = [];
  const linePts = [];
  const x0 = -1.15, y0 = 2.45; // règle dans la bande blanche du haut
  for (let i = 0; i <= steps; i++) {
    const t = i / steps;
    const th = t * Math.PI;
    arcPts.push([Math.cos(th), Math.sin(th)]);
    // Sur la règle : on déroule l'arc de 0 à π de gauche à droite
    linePts.push([x0 + (Math.PI - th), y0]);
  }

  // Courbe "fil rouge" (arc → segment)
  let curr = arcPts.map(p => p.slice());
  let curve = board.create('curve', [curr.map(p => p[0]), curr.map(p => p[1])],
                           { strokeColor: '#ef4444', strokeWidth: 4, fixed: true, highlight: false, layer: 6 });

  // --- Règle (style "règle") dans la bande blanche ---
  // Corps de la règle
  const rPadX = 0.20;
  const rPadY = 0.26;
  const r1 = board.create('point', [x0 - rPadX, y0 + rPadY], { visible: false, fixed: true, highlight: false });
  const r2 = board.create('point', [x0 + Math.PI + rPadX, y0 + rPadY], { visible: false, fixed: true, highlight: false });
  const r3 = board.create('point', [x0 + Math.PI + rPadX, y0 - rPadY], { visible: false, fixed: true, highlight: false });
  const r4 = board.create('point', [x0 - rPadX, y0 - rPadY], { visible: false, fixed: true, highlight: false });
  const rulerBody = board.create('polygon', [r1, r2, r3, r4], {
    fillColor: '#f8fafc',
    fillOpacity: 1,
    borders: { strokeColor: '#cbd5e1', strokeWidth: 2 },
    fixed: true,
    highlight: false,
    layer: 4
  });
  rulerBody.vertices.forEach(v => v.setAttribute({ visible: false, fixed: true, highlight: false }));

  // Trait principal de la règle (graduations)
  board.create('segment', [[x0, y0], [x0 + Math.PI, y0]], {
    strokeColor: '#64748b',
    strokeWidth: 3,
    fixed: true,
    highlight: false,
    layer: 5
  });

  // Graduations + labels
  const marks = [
    {k: 0,   label: '0',        major: true},
    {k: 1,   label: '&pi;/4',   major: false},
    {k: 2,   label: '&pi;/2',   major: true},
    {k: 3,   label: '3&pi;/4',  major: false},
    {k: 4,   label: '&pi;',     major: true},
  ];
  marks.forEach(({k, label, major}) => {
    const xk = x0 + k * (Math.PI / 4);
    const h  = major ? 0.16 : 0.11;
    board.create('segment', [[xk, y0 - h], [xk, y0 + h]], {
      strokeColor: '#64748b',
      strokeWidth: major ? 3 : 2,
      fixed: true,
      highlight: false,
      layer: 5
    });
    board.create('text', [xk, y0 - (rPadY + 0.08), label], {
      anchorX: 'middle',
      anchorY: 'top',
      fontSize: 12,
      strokeColor: '#0f172a',
      fixed: true,
      highlight: false,
      layer: 6
    });
  });

  // Indication "≈ 3,14" au niveau de π
  board.create('text', [x0 + Math.PI, y0 + (rPadY + 0.10), '&asymp; 3,14'], {
    anchorX: 'middle',
    anchorY: 'bottom',
    fontSize: 12,
    strokeColor: '#64748b',
    fixed: true,
    highlight: false,
    layer: 6
  });

  // --- Contrôles ---
  const slider = document.getElementById('slider');
  const btnPlay  = document.getElementById('btnPlay');
  const btnPause = document.getElementById('btnPause');
  const btnReset = document.getElementById('btnReset');
  const legend   = document.getElementById('legend');

  let playing = false;
  let rafId = null;
  let tAnim = 0;  // 0..1

  function setT(t){
    t = Math.max(0, Math.min(1, t));
    tAnim = t;
    slider.value = t.toFixed(3);

    // interpolation arcPts -> linePts
    curr = arcPts.map((p, i) => [
      (1 - t) * p[0] + t * linePts[i][0],
      (1 - t) * p[1] + t * linePts[i][1],
    ]);
    // recrée la courbe avec nouveaux points
    board.removeObject(curve);
    curve = board.create('curve', [curr.map(p => p[0]), curr.map(p => p[1])],
                         { strokeColor: '#ef4444', strokeWidth: 4, fixed: true, highlight: false, layer: 6 });
    board.update();

    if (legend){
      if (t < 1) legend.textContent = 'Le demi-cercle (longueur π) est déroulé sur la règle…';
      else       legend.innerHTML   = '<strong>Demi-périmètre = π</strong>  →  périmètre du cercle unité = <strong>2π</strong>';
    }
  }

  function tick(){
    if (!playing) return;
    // vitesse : ~3 secondes pour aller de 0 à 1
    const v = 1 / (3 * 60); // 60 fps approx
    const next = tAnim + v;
    setT(next >= 1 ? 1 : next);
    if (tAnim >= 1){
      playing = false;
      btnPlay.disabled = false;
      btnPause.disabled = true;
      btnReset.disabled = false;
      return;
    }
    rafId = requestAnimationFrame(tick);
  }

  // Slider interaction
  slider.addEventListener('input', (e) => {
    if (playing){ playing = false; cancelAnimationFrame(rafId); }
    setT(parseFloat(e.target.value));
    btnPlay.disabled  = (tAnim >= 1);
    btnPause.disabled = true;
    btnReset.disabled = (tAnim === 0);
  });

  // Boutons
  btnPlay.addEventListener('click', () => {
    if (tAnim >= 1) setT(0);
    playing = true;
    btnPlay.disabled  = true;
    btnPause.disabled = false;
    btnReset.disabled = true;
    rafId = requestAnimationFrame(tick);
  });

  btnPause.addEventListener('click', () => {
    if (!playing) return;
    playing = false;
    btnPlay.disabled  = false;
    btnPause.disabled = true;
    btnReset.disabled = (tAnim === 0);
    if (rafId) cancelAnimationFrame(rafId);
  });

  btnReset.addEventListener('click', () => {
    if (rafId) cancelAnimationFrame(rafId);
    playing = false;
    setT(0);
    btnPlay.disabled  = false;
    btnPause.disabled = true;
    btnReset.disabled = true;
  });

  // Lancer automatiquement au chargement
  setT(0);
  btnPlay.click();

  // Responsive : garder le cadrage large (dézoom) dans un conteneur carré
  const boxEl = document.getElementById('perimetre-box');
  function resizeSquare(){
    const w = boxEl.clientWidth;
    board.resizeContainer(w, w);  // carré
    board.setBoundingBox(BB, true);
  }
  resizeSquare();
  window.addEventListener('resize', resizeSquare);
})();
</script>
</body>
</html>
